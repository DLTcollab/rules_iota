SBASE = 'Release/src'
HBASE = 'Release/include'

licenses(['notice'])

cc_library(
    name='stdafx',
    hdrs=[SBASE + '/pch/stdafx.h'],
    srcs=[SBASE + '/pch/stdafx.h'],
    strip_include_prefix=SBASE + '/pch')

cc_library(
    name='cpprestsdk',
    srcs=glob(
        [
            SBASE + '/**/*.cpp',
            SBASE + '/**/*.h',
            HBASE + '/**/*.h',
        ],
        exclude=[
            SBASE + '/pplx/pplxapple.cpp',
            SBASE + '/pplx/pplxwin.cpp',
            SBASE + '/streams/fileio_winrt.cpp',
            SBASE + '/streams/fileio_win32.cpp',
            SBASE + '/http/listener/http_server_httpsys.cpp',
            SBASE + '/http/client/http_client_winrt.cpp',
            SBASE + '/http/client/http_client_winhttp.cpp',
            SBASE + '/websockets/**',
        ]),
    hdrs=glob([
        HBASE + '/pplx/*.h',
        HBASE + '/cpprest/**/*.h*',
        HBASE + '/cpprest/**/*.hpp*',
        HBASE + '/cpprest/**/*.dat*',
    ]),
    strip_include_prefix=HBASE,
    linkopts=['-lcrypto', '-lssl'],
    deps=[
        ':stdafx',
        '@boost//:system',
        '@boost//:regex',
        '@boost//:filesystem',
        '@boost//:chrono',
        '@boost//:atomic',
        '@boost//:thread',
        '@boost//:random',
    ],
    visibility=['//visibility:public'])
