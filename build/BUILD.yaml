config_setting(
    name="windows",
    values={"cpu": "x64_windows_msvc"},
    visibility=["//visibility:private"], )

config_setting(
    name="linux",
    values={"cpu": "k8"},
    visibility=["//visibility:private"], )

config_setting(
    name="darwin",
    values={"cpu": "darwin"},
    visibility=["//visibility:private"], )

cc_library(
    name="yaml",
    srcs=glob(["src/*.c"]),
    copts=select({
        ":windows": [
            "-DYAML_DECLARE_EXPORT",
            "-DHAVE_CONFIG_H",
        ],
        ":linux": [
            "-DYAML_DECLARE_EXPORT",
            "-DHAVE_CONFIG_H",
        ]
    }),
    hdrs=glob(["include/*.h"]) + select({
        ":windows": [glob(["win32/*.h")]
    }),
    strip_include_prefix='include',
    include_prefix='yaml',
    visibility=['//visibility:public'])
